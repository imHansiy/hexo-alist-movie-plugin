<style>
  /* 强制全宽样式，隐藏主题侧边栏 */
  #sidebar,
  .sidebar,
  .widget-wrap,
  .aside,
  .right-sidebar,
  .secondary,
  .col-sidebar,
  .sidebar-container {
    display: none !important;
    visibility: hidden !important;
    width: 0 !important;
    opacity: 0 !important;
  }

  #main,
  .main,
  .content,
  .main-content,
  .primary,
  .col-main,
  .content-container {
    width: 100% !important;
    max-width: 100% !important;
    float: none !important;
    margin: 0 auto !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  .container,
  .wrapper,
  .site-content,
  .page-content {
    max-width: 100% !important;
    width: 100% !important;
  }

  .grid,
  .row {
    grid-template-columns: 1fr !important;
    display: block !important;
  }
</style>

<% const isTV=movie.media_type==='tv' ; const isMovie=movie.media_type==='movie' ; %>

  <!-- 链接播放器专用样式 -->
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
  <link rel="stylesheet" href="/player/style.css">

  <div class="main-container">
    <!-- 左侧主内容区：播放器和影片信息 -->
    <div class="player-wrapper">
      <div class="player-container">
        <video id="player" playsinline controls></video>
      </div>
      <div class="movie-info">
        <!-- 影片封面 -->
        <div class="movie-poster-section">
          <div class="poster-container">
            <img class="movie-poster" id="movie-poster" alt="影片封面" style="display: none;" />
            <div class="poster-placeholder" id="poster-placeholder">
              <div class="placeholder-icon">🎬</div>
              <div class="placeholder-text">加载封面中...</div>
            </div>
          </div>
          <div class="movie-basic-info">
            <!-- 详细信息将由 script.js 根据下方注入的数据动态填充 -->
            <h1 class="movie-title"></h1>
            <div class="movie-meta">
              <div class="movie-details"></div>
            </div>
          </div>
        </div>
        <div class="movie-overview-box">
          <h2>剧情简介</h2>
          <p class="movie-overview"></p>
        </div>

        <!-- 电视剧特有信息占位符 -->
        <% if (isTV) { %>
          <div class="movie-tagline-box" style="display: none;">
            <h2>宣传语</h2>
            <p class="movie-tagline"></p>
          </div>
          <div class="movie-countries-box" style="display: none;">
            <h2>制作国家</h2>
            <p class="movie-countries"></p>
          </div>
          <div class="movie-networks-box" style="display: none;">
            <h2>播出平台</h2>
            <div class="networks-list"></div>
          </div>
          <div class="movie-companies-box" style="display: none;">
            <h2>制作公司</h2>
            <div class="companies-list"></div>
          </div>
          <div class="movie-creators-box" style="display: none;">
            <h2>创作者</h2>
            <div class="creators-list"></div>
          </div>
          <div class="episode-runtime-box" style="display: none;">
            <h2>单集时长</h2>
            <p class="episode-runtime"></p>
          </div>
          <div class="movie-language-box" style="display: none;">
            <h2>原始语言</h2>
            <p class="movie-language"></p>
          </div>
          <div class="movie-languages-box" style="display: none;">
            <h2>支持语言</h2>
            <p class="movie-languages"></p>
          </div>
          <% } %>
      </div>
    </div>

    <!-- 右侧边栏：选集或片源列表 -->
    <div class="recommendations">
      <!-- 此区域将由 script.js 动态填充 -->
    </div>
  </div>

  <!-- Hls.js 用于播放在线视频流 -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <!-- Plyr.js 播放器核心库 -->
  <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>

  <!-- 将当前影片数据注入到页面，供 script.js 使用 -->
  <script type="application/json"
    id="movie-json"><%- JSON.stringify(movie).replace(/<\/script/g,'<\\/script') %></script>

  <!-- 注入一个帮助脚本，确保 movieData 在主脚本加载前可用 -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      try {
        // 将JSON数据赋值给全局变量，以便 script.js 访问
        window.movieData = JSON.parse(document.getElementById('movie-json').textContent);
        console.log('电影数据已成功注入:', window.movieData.title);
      } catch (error) {
        console.error('电影数据注入失败:', error);
        window.movieData = null;
      }
    });
  </script>

  <!-- 加载主逻辑脚本 -->
  <script src="/player/script.js"></script>